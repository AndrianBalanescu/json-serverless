{"version":3,"sources":["webpack/bootstrap","/Users/uid10804/Documents/development2/json-serverless/packages/server/node_modules/webpack/buildin/module.js","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/app/app.config.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/app/cloud.app.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/app/core.app.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/app/index.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/coreserver/cloud.server.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/coreserver/dev.server.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/coreserver/index.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/coreserver/local.server.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/coreserver/server.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/coreserver/test.server.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/environment/cloud.environment.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/environment/dev.environment.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/environment/environment.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/environment/index.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/factory.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/server.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/specifications/index.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/specifications/swagger/swagger.config.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/specifications/swagger/swagger.defgen.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/specifications/swagger/swagger.spec.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/specifications/swagger/swagger.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/storage/file.storage.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/storage/index.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/storage/s3.storage.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/utils/logger.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/utils/output.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/validations/json.validator.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/validations/ruleevent.ts","/Users/uid10804/Documents/development2/json-serverless/packages/server/src/validations/validationrule.ts","external \"dotenv\"","external \"express\"","external \"express-list-endpoints\"","external \"fs\"","external \"json-server\"","external \"lodash\"","external \"lowdb\"","external \"lowdb-adapter-aws-s3\"","external \"lowdb/adapters/FileAsync\"","external \"pino\"","external \"swagger-ui-express\""],"names":[],"mappings":"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","file":"handler.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/server.ts\");\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","export class AppConfig {\n  readOnly = false;\n  enableSwagger = true;\n  enableApiKeyAuth = false;\n  jsonFile = 'db.json';\n  enableJSONValidation = true;\n\n  static merge = <T, U>(t: T, u: U) => Object.assign({}, t, u);\n}\n","import { CoreApp } from './core.app';\nimport { Output } from '../utils/output';\nexport class CloudApp extends CoreApp {\n  request = async () => {\n    try {\n      const { middlewares, router } = await this.initializeLayers();\n      this.setupServer(middlewares, router);\n    } catch (e) {\n      if (e.code === 'ExpiredToken') {\n        Output.setError(\n          `Please add valid credentials for AWS. Error: ${e.message}`\n        );\n      } else {\n        Output.setError(e.message);\n      }\n    }\n  };\n}\n","import { Logger } from '../utils/logger';\nimport { AppConfig } from './app.config';\nimport * as lowdb from 'lowdb';\nimport express from 'express';\nimport jsonServer = require('json-server');\nimport { StorageAdapter } from '../storage/storage';\nimport { ApiSpecification } from '../specifications/apispecification';\nimport { JSONValidator } from '../validations/json.validator';\nimport { Output } from '../utils/output';\n\nexport class CoreApp {\n  storageAdapter: StorageAdapter;\n  static storage = {} as lowdb.AdapterAsync;\n  static adapter = {} as lowdb.LowdbAsync<{}>;\n  logger = new Logger().logger;\n  appConfig: AppConfig;\n  protected server: express.Express;\n  private apispec: ApiSpecification;\n\n  constructor(\n    appConfig: AppConfig,\n    server: express.Express,\n    storageAdapter: StorageAdapter,\n    apispec: ApiSpecification\n  ) {\n    this.appConfig = appConfig;\n    this.server = server;\n    this.storageAdapter = storageAdapter;\n    this.apispec = apispec;\n  }\n\n  async setup(): Promise<void> {\n    await this.setupStorage();\n    const json = await this.getJSON();\n    const isValid = this.validateJSON(json);\n    if (isValid) {\n      await this.setupApp();\n      this.setupSwagger(json);\n      await this.setupRoutes();\n    } else {\n      Output.setError('provided json is not valid - see validation checks');\n      throw Error('provided json is not valid - see validation checks');\n    }\n  }\n\n  protected async setupStorage() {\n    CoreApp.storage = await this.storageAdapter.init();\n    CoreApp.adapter = await lowdb.default(CoreApp.storage);\n  }\n\n  protected async setupApp(): Promise<void> {\n    const { middlewares, router } = await this.initializeLayers();\n    this.setupServer(middlewares, router);\n  }\n\n  protected validateJSON(db: {}): boolean {\n    let isValid = true;\n    if (this.appConfig.enableJSONValidation) {\n      isValid = JSONValidator.validate(db);\n    }\n    return isValid;\n  }\n\n  protected async getJSON(): Promise<object> {\n    const json = await CoreApp.adapter.getState();\n    return json;\n  }\n\n  protected setupSwagger(db: {}): void {\n    if (this.appConfig.enableSwagger) {\n      this.apispec.generateSpecification(db, true);\n    }\n  }\n\n  protected setupRoutes(): void {\n    this.server.use('/reload', async () => {\n      Error('not implemented');\n    });\n  }\n\n  protected async initializeLayers() {\n    if (\n      CoreApp.adapter &&\n      Object.entries(CoreApp.adapter).length === 0 &&\n      CoreApp.adapter.constructor === Object\n    ) {\n      CoreApp.adapter = await lowdb.default(CoreApp.storage);\n    }\n    const router = jsonServer.router(CoreApp.adapter);\n    const middlewares = jsonServer.defaults({\n      readOnly: this.appConfig.readOnly,\n    });\n    return { middlewares, router };\n  }\n\n  protected setupServer(\n    middlewares: express.Handler[],\n    router: express.Router\n  ) {\n    if (this.appConfig.enableSwagger) {\n      middlewares.splice(\n        middlewares.findIndex(x => x.name === 'serveStatic'),\n        1\n      );\n    }\n    this.server.use(middlewares);\n    this.server.use('/api', router);\n  }\n}\n","export * from './cloud.app';\nexport * from './core.app';\nexport * from './app.config';\n","import { CloudApp } from '../app';\nimport { CoreServer } from './server';\nimport express from 'express';\n\nexport class CloudServer extends CoreServer {\n  core: CloudApp;\n  constructor(server: express.Express, core: CloudApp) {\n    super(server, core);\n    this.server = server;\n    this.core = core;\n  }\n\n  async init(): Promise<void> {\n    await this.core.setup();\n    await this.core.request();\n  }\n}\n","import { CoreServer } from './server';\nimport { CloudApp } from '../app';\nimport express from 'express';\n\nexport class DevServer extends CoreServer {\n  core: CloudApp;\n  constructor(server: express.Express, core: CloudApp) {\n    super(server, core);\n    this.server = server;\n    this.core = core;\n  }\n\n  async init(): Promise<void> {\n    await this.core.setup();\n    await this.core.request();\n    this.start(this.server, 3000);\n  }\n}\n","export * from './cloud.server';\nexport * from './dev.server';\nexport * from './local.server';\nexport * from './test.server';\n","import { CoreServer } from './server';\n\nexport class LocalServer extends CoreServer {\n  async init(): Promise<void> {\n    await this.core.setup();\n    this.start(this.server, 3000);\n  }\n}\n","import express from 'express';\nimport { Logger } from '../utils/logger';\nconst logger = new Logger().logger;\nimport { CoreApp } from '../app/core.app';\nexport abstract class CoreServer {\n  core: CoreApp;\n  server: express.Express;\n  constructor(server: express.Express, core: CoreApp) {\n    this.server = server;\n    this.core = core;\n  }\n  abstract async init(): Promise<void>;\n  protected start(server: express.Express, port: number) {\n    // start the web server\n    server.listen(port);\n    logger.info(\n      `JSON Server is running under port ${port}. Use http://localhost:${port} to access it`\n    );\n  }\n}\n","import { CoreServer } from './server';\n\nexport class TestServer extends CoreServer {\n  async init(): Promise<void> {\n    await this.core.setup();\n  }\n}\n","import { Environment } from './environment';\n\nexport class CloudEnvironment extends Environment {\n  s3File: string;\n  s3Bucket: string;\n\n  constructor() {\n    super();\n    this.s3File = process.env.s3File as string;\n    this.s3Bucket = process.env.s3Bucket as string;\n    this.basePath = process.env.basePath as string;\n  }\n}\n","import { Environment } from './environment';\nimport * as dotenv from 'dotenv';\nexport class DevEnvironment extends Environment {\n  s3File: string;\n  s3Bucket: string;\n\n  constructor() {\n    super();\n    dotenv.config();\n    this.s3File = process.env.s3File as string;\n    this.s3Bucket = process.env.s3Bucket as string;\n    this.basePath = process.env.basePath as string;\n  }\n}\n","export class Environment {\n  basePath = '/';\n\n  constructor() {\n    this.basePath = '/';\n  }\n}\n","export * from './cloud.environment';\nexport * from './environment';\nexport * from './dev.environment';\n","import express from 'express';\nimport { LocalServer, DevServer, CloudServer, TestServer } from './coreserver';\nimport { CloudApp, CoreApp, AppConfig } from './app';\nimport {\n  StorageAdapter,\n  FileStorageAdapter,\n  S3StorageAdapter,\n} from './storage';\nimport { ApiSpecification, Swagger, SwaggerConfig } from './specifications';\nimport { CoreServer } from './coreserver/server';\nimport { Environment, DevEnvironment, CloudEnvironment } from './environment';\n\nexport class ServerFactory {\n  static createServer = async (\n    type: string,\n    server: express.Express,\n    appConfig: AppConfig\n  ): Promise<CoreServer> => {\n    let coreserver = {} as CoreServer;\n\n    switch (type) {\n      case 'local': {\n        coreserver = ServerFactory.create(\n          LocalServer,\n          CoreApp,\n          Environment,\n          new FileStorageAdapter(appConfig.jsonFile),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'debug': {\n        coreserver = ServerFactory.create(\n          LocalServer,\n          CoreApp,\n          Environment,\n          new FileStorageAdapter(appConfig.jsonFile),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'development': {\n        const environment = new DevEnvironment();\n        coreserver = ServerFactory.create(\n          DevServer,\n          CloudApp,\n          DevEnvironment,\n          new S3StorageAdapter(environment.s3Bucket, environment.s3File),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'offline': {\n        const environment = new CloudEnvironment();\n        coreserver = ServerFactory.create(\n          CloudServer,\n          CloudApp,\n          DevEnvironment,\n          new S3StorageAdapter(environment.s3Bucket, environment.s3File),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'test': {\n        coreserver = ServerFactory.create(\n          TestServer,\n          CoreApp,\n          Environment,\n          new FileStorageAdapter(appConfig.jsonFile),\n          appConfig,\n          server\n        );\n        break;\n      }\n      default: {\n        const environment = new CloudEnvironment();\n        coreserver = ServerFactory.create(\n          CloudServer,\n          CloudApp,\n          CloudEnvironment,\n          new S3StorageAdapter(environment.s3Bucket, environment.s3File),\n          appConfig,\n          server\n        );\n        break;\n      }\n    }\n    await coreserver.init();\n    return coreserver;\n  };\n\n  static create<\n    C extends CoreServer,\n    A extends CoreApp,\n    E extends Environment,\n    S extends StorageAdapter\n  >(\n    coreserver: { new (server: express.Express, app: A): C },\n    app: {\n      new (\n        appConfig: AppConfig,\n        server: express.Express,\n        storage: S,\n        specification: ApiSpecification\n      ): A;\n    },\n    environment: { new (): E },\n    storage: S,\n    appConfig: AppConfig,\n    server: express.Express\n  ): C {\n    const env = new environment();\n    const swagger = new Swagger(\n      server,\n      new SwaggerConfig(appConfig.readOnly, appConfig.enableApiKeyAuth),\n      env.basePath\n    );\n    const core = new coreserver(\n      server,\n      new app(appConfig, server, storage, swagger)\n    );\n    return core;\n  }\n}\n","import express from 'express';\nimport { ServerFactory } from './factory';\nimport { AppConfig } from './app/app.config';\n\nexport const startServer = async (\n  environment: string,\n  server: express.Express,\n  appConfig: AppConfig\n) => {\n  ServerFactory.createServer(environment, server, appConfig);\n};\n\n(async () => {\n  if (require.main === module) {\n    const server = express();\n    const defaultConfig = new AppConfig();\n    defaultConfig.jsonFile = '../../db.json';\n    startServer(process.env.NODE_ENV as string, server, defaultConfig);\n  }\n})();\n","export * from './apispecification';\nexport * from './swagger/swagger';\nexport * from './swagger/swagger.config';\n","export class SwaggerConfig {\n  readOnly = false;\n  enableApiKeyAuth = false;\n\n  constructor(readOnly: boolean, enableApiKeyAuth: boolean) {\n    this.readOnly = readOnly;\n    this.enableApiKeyAuth = enableApiKeyAuth;\n  }\n}\n","/* eslint-disable no-use-before-define */\n\nexport class SwaggerDefGen {\n  private outSwagger = '';\n  private tabCount = 0;\n  private indentator = '';\n  private nullType = 'string';\n  // ---- Functions definitions ----\n  private changeIndentation(count: number) {\n    /*\n      Assign 'this.indentator' a string beginning with newline and followed by 'count' tabs\n      Updates variable 'tabCount' with the number of tabs used\n      Global variables updated:\n      -identator\n      -tabcount\n      */\n\n    let i;\n    if (count >= this.tabCount) {\n      i = this.tabCount;\n    } else {\n      i = 0;\n      this.indentator = '\\n';\n    }\n    for (; i < count; i += 1) {\n      this.indentator += '\\t';\n    }\n    // Update tabCount\n    this.tabCount = count;\n  }\n\n  private isFloatNumber(num: number) {\n    return Number(num) === num && num % 1 !== 0;\n  }\n  private convertNumber(num: number) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given number\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    if (Number.isInteger(num)) {\n      this.outSwagger += `${this.indentator}\"type\": \"integer\",`;\n      if (num < 2147483647 && num > -2147483647) {\n        this.outSwagger += `${this.indentator}\"format\": \"int32\"`;\n      } else if (Number.isSafeInteger(num)) {\n        this.outSwagger += `${this.indentator}\"format\": \"int64\"`;\n      } else {\n        this.outSwagger += `${this.indentator}\"format\": \"unsafe\"`;\n      }\n    } else if (this.isFloatNumber(num)) {\n      this.outSwagger += `${this.indentator}\"format\": \"double\"`;\n    } else {\n      this.outSwagger += `${this.indentator}\"format\": \"unsafe\"`;\n    }\n    this.outSwagger += `,${this.indentator}\"example\": \"${num}\"`;\n  }\n\n  // date is ISO8601 format - https://xml2rfc.tools.ietf.org/public/rfc/html/rfc3339.html#anchor14\n  private convertString(str: string) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given string\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    const regxDate = /^(19|20)\\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/;\n    const regxDateTime = /^(19|20)\\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01]).([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\\.[0-9]{1,2})?(Z|(\\+|-)([0-1][0-9]|2[0-3]):[0-5][0-9])$/;\n\n    this.outSwagger += `${this.indentator}\"type\": \"string\"`;\n    if (regxDateTime.test(str)) {\n      this.outSwagger += ',';\n      this.outSwagger += `${this.indentator}\"format\": \"date-time\"`;\n    } else if (regxDate.test(str)) {\n      this.outSwagger += ',';\n      this.outSwagger += `${this.indentator}\"format\": \"date\"`;\n    }\n\n    this.outSwagger += `,${this.indentator}\"example\": \"${str}\"`;\n  }\n\n  private convertArray(obj: object) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given array\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    this.outSwagger += `${this.indentator}\"type\": \"array\",`;\n    // ---- Begin items scope ----\n    this.outSwagger += `${this.indentator}\"items\": {`;\n    this.conversorSelection(obj);\n    this.outSwagger += `${this.indentator}}`;\n    // ---- End items scope ----\n  }\n\n  private convertObject(obj: object) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given object\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    // Convert null attributes to given type\n    if (obj === null) {\n      this.outSwagger += `${this.indentator}\"type\": \"${this.nullType}\",`;\n      this.outSwagger += `${this.indentator}\"format\": \"nullable\"`;\n      return;\n    }\n    // ---- Begin properties scope ----\n    this.outSwagger += `${this.indentator}\"type\": \"object\",`;\n    this.outSwagger += `${this.indentator}\"properties\": {`;\n    this.changeIndentation(this.tabCount + 1);\n    // For each attribute inside that object\n    Object.keys(obj).forEach(prop => {\n      // ---- Begin property type scope ----\n      this.outSwagger += `${this.indentator}\"${prop}\": {`;\n      this.conversorSelection(obj[prop]);\n      this.outSwagger += `${this.indentator}},`;\n      // ---- End property type scope ----\n    });\n\n    this.changeIndentation(this.tabCount - 1);\n    if (Object.keys(obj).length > 0) {\n      // At least 1 property inserted\n      this.outSwagger = this.outSwagger.substring(\n        0,\n        this.outSwagger.length - 1\n      ); // Remove last comma\n      this.outSwagger += `${this.indentator}}`;\n    } else {\n      // No property inserted\n      this.outSwagger += ' }';\n    }\n  }\n\n  private conversorSelection(obj: object) {\n    this.changeIndentation(this.tabCount + 1);\n    if (typeof obj === 'number') {\n      // attribute is a number\n      this.convertNumber(obj);\n    } else if (Object.prototype.toString.call(obj) === '[object Array]') {\n      // attribute is an array\n      this.convertArray(obj[0]);\n    } else if (typeof obj === 'object') {\n      // attribute is an object\n      this.convertObject(obj);\n    } else if (typeof obj === 'string') {\n      // attribute is a string\n      this.convertString(obj);\n    } else if (typeof obj === 'boolean') {\n      // attribute is a boolean\n      this.outSwagger += `${this.indentator}\"type\": \"boolean\"`;\n    } else {\n      // not a valid Swagger type\n      throw new Error(\n        `Property type \"${typeof obj}\" not valid for Swagger definitions`\n      );\n    }\n    this.changeIndentation(this.tabCount - 1);\n  }\n\n  generateDefinitions = (json: object) => {\n    this.tabCount = 0;\n    this.indentator = '\\n';\n    // ---- Begin definitions ----\n    this.outSwagger = '{\"definitions\": {';\n    this.changeIndentation(1);\n    // For each object inside the JSON\n\n    Object.keys(json).forEach(obj => {\n      this.outSwagger += `${this.indentator}\"${obj}\": {`;\n      this.conversorSelection(json[obj]);\n      this.outSwagger += `${this.indentator}},`;\n    });\n\n    // Remove last comma\n    this.outSwagger = this.outSwagger.substring(0, this.outSwagger.length - 1);\n    // ---- End definitions ----\n    this.changeIndentation(this.tabCount - 1);\n    this.outSwagger += `${this.indentator}}}`;\n    const jsonDefinition = JSON.parse(this.outSwagger);\n    return jsonDefinition;\n  };\n}\n","import _ from 'lodash';\nconst listEndpoints = require('express-list-endpoints');\nimport express from 'express';\nimport {\n  Info,\n  Spec,\n  Schema,\n  ApiKeySecurity,\n  Operation,\n  QueryParameter,\n  BodyParameter,\n  Reference,\n} from 'swagger-schema-official';\nimport fs from 'fs';\n\ninterface EndPoint {\n  path: string;\n  methods: string[];\n}\n\nclass PackageInfo {\n  name = '';\n  version = '';\n  title = '';\n  license = '';\n  description = '';\n}\n\nexport class SwaggerSpec {\n  private packageJsonPath = `${process.cwd()}/package.json`;\n\n  private packageInfo = new PackageInfo();\n  private app = {} as express.Express;\n  private predefinedSpec = {} as object;\n  private spec = {} as Spec;\n\n  constructor() {}\n  private updateSpecFromPackage(basePath: string): Info {\n    const newInfo: Info = {\n      version: '',\n      title: '',\n    };\n    this.packageInfo = JSON.parse(\n      fs.readFileSync(this.packageJsonPath, 'UTF-8')\n    ) as PackageInfo;\n    if (this.packageInfo.name) {\n      newInfo.title = this.packageInfo.name;\n    }\n    if (this.packageInfo.version) {\n      newInfo.version = this.packageInfo.version;\n    }\n    if (this.packageInfo.license) {\n      newInfo.license = { name: this.packageInfo.license };\n    }\n    newInfo.description = `[Specification JSON](${basePath}/api-spec)`;\n\n    if (this.packageInfo.description) {\n      newInfo.description += `\\n\\n${this.packageInfo.description}`;\n    }\n    return newInfo;\n  }\n  private sortObject(o: object) {\n    const sorted = {};\n    let key;\n    const a = Object.keys(o);\n    a.sort();\n    for (key = 0; key < a.length; key += 1) {\n      sorted[a[key]] = o[a[key]];\n    }\n    return sorted;\n  }\n\n  initSpec(readOnly: boolean, basePath: string) {\n    const info = this.updateSpecFromPackage(basePath);\n    let specification: Spec = {\n      swagger: '2.0',\n      paths: {},\n      info,\n    };\n    specification.swagger = '2.0';\n    specification.paths = {};\n    const excludedRoutes = ['/api/:resource/:id/:nested', '/api/db'];\n    const endpoints = listEndpoints(this.app);\n    endpoints.forEach((endpoint: EndPoint) => {\n      if (readOnly) {\n        for (let i = 0; i < endpoint.methods.length; i += 1) {\n          if (endpoint.methods[i] !== 'GET') {\n            endpoint.methods.splice(i, 1);\n            i -= 1;\n          }\n        }\n      }\n      if (!excludedRoutes.includes(endpoint.path)) {\n        const params = new Array<string>();\n        let { path } = endpoint;\n        const matches = path.match(/:([^/]+)/g);\n        if (matches) {\n          matches.forEach(found => {\n            const paramName = found.substr(1);\n            path = path.replace(found, `{${paramName}}`);\n            params.push(paramName);\n          });\n        }\n\n        if (!specification.paths[path]) {\n          specification.paths[path] = {};\n        }\n        endpoint.methods.forEach(m => {\n          specification.paths[path][m.toLowerCase()] = {\n            summary: path,\n            consumes: ['application/json'],\n            parameters:\n              params.map(p => ({\n                name: p,\n                in: 'path',\n                required: true,\n                type: 'integer',\n              })) || [],\n            responses: {},\n          };\n        });\n      }\n    });\n\n    specification.basePath = basePath;\n    specification = this.sortObject(\n      _.merge(specification, this.predefinedSpec || {})\n    ) as Spec;\n    return specification;\n  }\n\n  getSpec = (\n    app: express.Express,\n    predefinedSpec: object,\n    readOnly: boolean,\n    basePath: string\n  ) => {\n    this.app = app;\n    this.predefinedSpec = predefinedSpec;\n    this.spec = this.initSpec(readOnly, basePath);\n    return this.spec;\n  };\n\n  setSchemaReference(spec: Spec, definition: string): Reference {\n    let schemaDef = {} as Reference;\n    if (spec.definitions![definition].type === 'array') {\n      schemaDef = { $ref: `#/definitions/${definition}/items` } as Reference;\n    } else if (spec.definitions![definition].type === 'object') {\n      schemaDef = { $ref: `#/definitions/${definition}` } as Reference;\n    }\n    return schemaDef;\n  }\n\n  private getDefaultParameterSchema(\n    schemaDef: Schema,\n    definition: string\n  ): BodyParameter {\n    return {\n      schema: schemaDef,\n      in: 'body',\n      name: 'body',\n      description: definition,\n      required: true,\n    };\n  }\n\n  getQueryParameterSchema(): QueryParameter[] {\n    return [\n      {\n        name: '_page',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to return paginated data',\n      },\n      {\n        name: '_limit',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to limit paginated data',\n      },\n      {\n        name: '_sort',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'sort by attributes',\n      },\n      {\n        name: '_order',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'order ascending or descending',\n        enum: ['asc', 'desc'],\n      },\n      {\n        name: '_start',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to set start sliced data',\n      },\n      {\n        name: '_end',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to set start sliced data',\n      },\n      {\n        name: 'q',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'full text search',\n      },\n      {\n        name: '_embed',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'include children resources',\n      },\n      {\n        name: '_expand',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'include parent resource',\n      },\n    ];\n  }\n\n  private getDefaultPostResponses(definition: string) {\n    return {\n      responses: {\n        200: {\n          description: 'successful operation',\n          schema: {\n            $ref: `#/definitions/${definition}`,\n          },\n        },\n        400: {\n          description: `Invalid ${definition}`,\n        },\n      },\n    };\n  }\n\n  private getDefaultPutResponses(definition: string) {\n    return {\n      responses: {\n        400: {\n          description: 'Invalid ID supplied',\n        },\n        404: {\n          description: `${definition} not found`,\n        },\n        405: {\n          description: 'Validation exception',\n        },\n      },\n    };\n  }\n\n  private getDefaultDeleteResponses(definition: string) {\n    return {\n      responses: {\n        400: {\n          description: 'Invalid ID supplied',\n        },\n        404: {\n          description: `${definition} not found`,\n        },\n      },\n    };\n  }\n\n  private getDefaultSchemaProperties(definition: string) {\n    return {\n      produces: ['application/json'],\n      tags: [definition],\n    };\n  }\n\n  addSchemaDefitions = (specificaton: Spec, schemaDefinitons: Schema) => {\n    const spec = Object.assign(specificaton, schemaDefinitons) as Spec;\n    Object.keys(spec.paths).forEach(path => {\n      Object.keys(spec.definitions!).forEach((definition: string) => {\n        const schemaDef = this.setSchemaReference(spec, definition);\n        if (path.endsWith(definition)) {\n          if (spec.paths[path].get) {\n            const operation = spec.paths[path].get as Operation;\n            Object.assign(\n              spec.paths[path].get,\n              this.getDefaultSchemaProperties(definition)\n            );\n            operation.responses[200] = {\n              schema: { $ref: `#/definitions/${definition}` },\n              description: 'successful operation',\n            };\n            operation.parameters = this.getQueryParameterSchema();\n          }\n          if (spec.paths[path].post) {\n            const operation = spec.paths[path].post as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPostResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n          if (spec.paths[path].put) {\n            const operation = spec.paths[path].put as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n          if (spec.paths[path].patch) {\n            const operation = spec.paths[path].patch as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n        }\n        if (path.endsWith(`${definition}/{id}`)) {\n          if (spec.paths[path].get) {\n            const operation = spec.paths[path].get as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            operation.responses[200] = {\n              schema: { $ref: `#/definitions/${definition}` },\n              description: 'successful operation',\n            };\n          }\n          if (spec.paths[path].delete) {\n            const operation = spec.paths[path].delete as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(\n              operation,\n              this.getDefaultDeleteResponses(definition)\n            );\n          }\n\n          if (spec.paths[path].put) {\n            const operation = spec.paths[path].put as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n          if (spec.paths[path].patch) {\n            const operation = spec.paths[path].patch as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n        }\n      });\n    });\n    return spec;\n  };\n\n  addAuthentication = (specificaton: Spec, auth: ApiKeySecurity) => {\n    const spec = Object.assign(specificaton.securityDefinitions, auth);\n    return spec;\n  };\n}\n","import * as swaggerUi from 'swagger-ui-express';\nimport { SwaggerSpec } from './swagger.spec';\nimport { SwaggerDefGen } from './swagger.defgen';\nimport { Logger } from '../../utils/logger';\nimport express from 'express';\nimport { Spec, ApiKeySecurity } from 'swagger-schema-official';\nimport { SwaggerConfig } from './swagger.config';\nimport { ApiSpecification } from '../apispecification';\nimport { Output } from '../../utils/output';\n\nexport class Swagger implements ApiSpecification {\n  private swaggerSpec = new SwaggerSpec();\n  private swaggerDefGen = new SwaggerDefGen();\n  private logger = new Logger().logger;\n  private spec = {} as Spec;\n  private server: express.Express;\n  private config: SwaggerConfig;\n  private basePath: string;\n  constructor(\n    server: express.Express,\n    config: SwaggerConfig,\n    basePath: string\n  ) {\n    this.server = server;\n    this.config = config;\n    this.basePath = basePath;\n  }\n\n  generateSpecification = (json: object, regenerate: boolean) => {\n    if (!this.spec || regenerate) {\n      Output.setInfo('Init Swagger');\n      const swaggerSchemaDefinitions = this.swaggerDefGen.generateDefinitions(\n        json\n      );\n      this.spec = this.swaggerSpec.getSpec(\n        this.server,\n        {},\n        this.config.readOnly,\n        this.basePath\n      );\n      const auth: ApiKeySecurity = {\n        type: 'apiKey',\n        in: 'header',\n        name: 'x-api-key',\n        description:\n          'All requests must include the `x-api-key` header containing your account ID.',\n      };\n\n      if (this.config.enableApiKeyAuth) {\n        this.swaggerSpec.addAuthentication(this.spec, auth);\n      }\n      this.swaggerSpec.addSchemaDefitions(this.spec, swaggerSchemaDefinitions);\n    }\n    this.server.use('/api-spec', (req, res) => {\n      res.setHeader('Content-Type', 'application/json');\n      res.send(this.spec);\n    });\n    this.server.use('/', swaggerUi.serve, swaggerUi.setup(this.spec));\n  };\n}\n","import { StorageAdapter } from './storage';\nimport fs from 'fs';\nimport FileAsync from 'lowdb/adapters/FileAsync';\n\nexport class FileStorageAdapter implements StorageAdapter {\n  private initialFilePath: string;\n  constructor(initialFilePath: string) {\n    this.initialFilePath = initialFilePath;\n  }\n\n  async init(): Promise<import('lowdb').AdapterAsync> {\n    const storageAdapter = new FileAsync(this.initialFilePath);\n    return storageAdapter;\n  }\n}\n","export * from './file.storage';\nexport * from './storage';\nexport * from './s3.storage';\n","import { StorageAdapter } from './storage';\nimport fs from 'fs';\nconst awsAdapter = require('lowdb-adapter-aws-s3');\n\nexport class S3StorageAdapter implements StorageAdapter {\n  private s3bucket: string;\n  private s3file: string;\n  constructor(s3bucket: string, s3file: string) {\n    this.s3bucket = s3bucket;\n    this.s3file = s3file;\n  }\n\n  async init(): Promise<import('lowdb').AdapterAsync> {\n    const db = JSON.parse(fs.readFileSync(this.s3file, 'UTF-8'));\n    const storageAdapter = new awsAdapter(this.s3file, {\n      defaultValue: db,\n      aws: { bucketName: this.s3bucket },\n    });\n    return storageAdapter;\n  }\n}\n","export class Logger {\n  logger = require('pino')(\n    {\n      prettyPrint: { colorize: true },\n    },\n    process.stderr\n  );\n}\n","import { Logger } from './logger';\n\nexport class Output {\n  static setWarning(message: string) {\n    new Logger().logger.warning(message);\n  }\n  static setError(message: string) {\n    new Logger().logger.error(message);\n  }\n  static setInfo(message: string) {\n    new Logger().logger.info(message);\n  }\n}\n","import {\n  HasIdAttributeRule,\n  HasObjectKeyRule,\n  IsObjectRule,\n  ValidationRule,\n} from './validationrule';\nimport { RuleResultSeverity } from './ruleevent';\nimport { Output } from '../utils/output';\nexport class JSONValidator {\n  static validate(json: {}): boolean {\n    let isValid = true;\n    const rules = new Array<ValidationRule>();\n    rules.push(new IsObjectRule(json));\n    rules.push(new HasObjectKeyRule(json));\n    rules.push(new HasIdAttributeRule(json));\n\n    Output.setInfo(\n      'ValidationRule:' +\n        'Result'.padStart(60 - 'ValidationRule'.length) +\n        'Message'.padStart(80)\n    );\n    for (const rule of rules) {\n      const results = rule.executeValidation();\n      for (const result of results.events) {\n        Output.setInfo(\n          results.validationRule +\n            ':' +\n            result.result\n              .toString()\n              .padStart(60 - results.validationRule!.length) +\n            result.message.padStart(80)\n        );\n        if (result.result === RuleResultSeverity.ALERT) {\n          isValid = false;\n        }\n      }\n    }\n    return isValid;\n  }\n}\n","export class RuleEventList {\n  validationRule?: string;\n  events = new Array<RuleEvent>();\n}\n\nexport class RuleEvent {\n  result: RuleResultSeverity;\n  message = '' as string;\n\n  constructor(result: RuleResultSeverity, message?: string) {\n    this.result = result;\n    this.message = message !== undefined ? message : '';\n  }\n}\n\nexport enum RuleResultSeverity {\n  OK = 'OK',\n  WARNING = 'WARNING',\n  ALERT = 'ALERT',\n}\n","import { RuleEvent, RuleResultSeverity, RuleEventList } from './ruleevent';\n\nexport abstract class ValidationRule {\n  protected jsonObject = {} as object;\n  ruleEvents = new Array<RuleEvent>();\n  constructor(jsonObject: {}) {\n    this.jsonObject = jsonObject;\n  }\n  events = new Array<string>();\n  executeValidation(): RuleEventList {\n    const ruleEventList = new RuleEventList();\n    const result = this.validate();\n    ruleEventList.events = ruleEventList.events.concat(result);\n    ruleEventList.validationRule = this.constructor.name;\n    return ruleEventList;\n  }\n\n  protected abstract validate(): RuleEvent[];\n}\n\nexport class IsObjectRule extends ValidationRule {\n  validate(): RuleEvent[] {\n    let ruleSeverity = RuleResultSeverity.OK;\n    let message = '';\n    try {\n      if (\n        this.jsonObject &&\n        typeof this.jsonObject === 'object' &&\n        this.jsonObject.constructor !== Object\n      ) {\n        ruleSeverity = RuleResultSeverity.ALERT;\n        message = 'root level of json content must be a json object';\n      }\n    } catch (e) {\n      ruleSeverity = RuleResultSeverity.ALERT;\n      message = e.message;\n    }\n    this.ruleEvents.push(new RuleEvent(ruleSeverity, message));\n    return this.ruleEvents;\n  }\n}\n\nexport class HasObjectKeyRule extends ValidationRule {\n  validate(): RuleEvent[] {\n    let ruleSeverity = RuleResultSeverity.OK;\n    let message = '';\n    try {\n      if (this.jsonObject && typeof this.jsonObject === 'object') {\n        if (Object.keys(this.jsonObject).length === 0) {\n          ruleSeverity = RuleResultSeverity.ALERT;\n          message = 'no root properties found - no endpoints can be created';\n        }\n      }\n    } catch (e) {\n      ruleSeverity = RuleResultSeverity.ALERT;\n      message = e.message;\n    }\n    this.ruleEvents.push(new RuleEvent(ruleSeverity, message));\n    return this.ruleEvents;\n  }\n}\n\nexport class HasIdAttributeRule extends ValidationRule {\n  validate(): RuleEvent[] {\n    try {\n      if (\n        this.jsonObject &&\n        typeof this.jsonObject === 'object' &&\n        Object.keys(this.jsonObject).length !== 0\n      ) {\n        Object.keys(this.jsonObject).forEach(item => {\n          let ruleSeverity = RuleResultSeverity.OK;\n          let message = '';\n          if (\n            Array.isArray(this.jsonObject[item]) &&\n            this.jsonObject[item].length > 0 &&\n            !this.jsonObject[item][0].hasOwnProperty('id')\n          ) {\n            (ruleSeverity = RuleResultSeverity.WARNING),\n              (message =\n                item +\n                ' is missing id attribute - not possible to do POST, PUT, PATCH');\n          }\n          this.ruleEvents.push(new RuleEvent(ruleSeverity, message));\n        });\n      }\n    } catch (e) {\n      const ruleSeverityError = RuleResultSeverity.ALERT;\n      const messageError = e.message;\n      this.ruleEvents.push(new RuleEvent(ruleSeverityError, messageError));\n    }\n    return this.ruleEvents;\n  }\n}\n","module.exports = require(\"dotenv\");","module.exports = require(\"express\");","module.exports = require(\"express-list-endpoints\");","module.exports = require(\"fs\");","module.exports = require(\"json-server\");","module.exports = require(\"lodash\");","module.exports = require(\"lowdb\");","module.exports = require(\"lowdb-adapter-aws-s3\");","module.exports = require(\"lowdb/adapters/FileAsync\");","module.exports = require(\"pino\");","module.exports = require(\"swagger-ui-express\");"],"sourceRoot":""}