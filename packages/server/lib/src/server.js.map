{"version":3,"sources":["webpack://MyLib/webpack/universalModuleDefinition","webpack://MyLib/webpack/bootstrap","webpack://MyLib/(webpack)/buildin/module.js","webpack://MyLib/./src/app/app.config.ts","webpack://MyLib/./src/app/cloud.app.ts","webpack://MyLib/./src/app/core.app.ts","webpack://MyLib/./src/app/index.ts","webpack://MyLib/./src/coreserver/cloud.server.ts","webpack://MyLib/./src/coreserver/dev.server.ts","webpack://MyLib/./src/coreserver/index.ts","webpack://MyLib/./src/coreserver/local.server.ts","webpack://MyLib/./src/coreserver/server.ts","webpack://MyLib/./src/coreserver/test.server.ts","webpack://MyLib/./src/environment/cloud.environment.ts","webpack://MyLib/./src/environment/dev.environment.ts","webpack://MyLib/./src/environment/environment.ts","webpack://MyLib/./src/environment/index.ts","webpack://MyLib/./src/factory.ts","webpack://MyLib/./src/server.ts","webpack://MyLib/./src/specifications/index.ts","webpack://MyLib/./src/specifications/swagger/swagger.config.ts","webpack://MyLib/./src/specifications/swagger/swagger.defgen.ts","webpack://MyLib/./src/specifications/swagger/swagger.spec.ts","webpack://MyLib/./src/specifications/swagger/swagger.ts","webpack://MyLib/./src/storage/file.storage.ts","webpack://MyLib/./src/storage/index.ts","webpack://MyLib/./src/storage/s3.storage.ts","webpack://MyLib/./src/utils/logger.ts","webpack://MyLib/./src/utils/output.ts","webpack://MyLib/./src/validations/json.validator.ts","webpack://MyLib/./src/validations/ruleevent.ts","webpack://MyLib/./src/validations/validationrule.ts","webpack://MyLib/external \"dotenv\"","webpack://MyLib/external \"express\"","webpack://MyLib/external \"express-list-endpoints\"","webpack://MyLib/external \"fs\"","webpack://MyLib/external \"json-server\"","webpack://MyLib/external \"lodash\"","webpack://MyLib/external \"lowdb\"","webpack://MyLib/external \"lowdb-adapter-aws-s3\"","webpack://MyLib/external \"lowdb/adapters/FileAsync\"","webpack://MyLib/external \"pino\"","webpack://MyLib/external \"swagger-ui-express\""],"names":[],"mappings":"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","file":"src/server.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"MyLib\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MyLib\"] = factory();\n\telse\n\t\troot[\"MyLib\"] = factory();\n})(global, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/server.ts\");\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","export class AppConfig {\n  readOnly = false;\n  enableSwagger = true;\n  enableApiKeyAuth = false;\n  jsonFile = 'db.json';\n  enableJSONValidation = true;\n\n  static merge = <T, U>(t: T, u: U) => Object.assign({}, t, u);\n}\n","import { CoreApp } from './core.app';\nimport { Output } from '../utils/output';\nexport class CloudApp extends CoreApp {\n  request = async () => {\n    try {\n      const { middlewares, router } = await this.initializeLayers();\n      this.setupServer(middlewares, router);\n    } catch (e) {\n      if (e.code === 'ExpiredToken') {\n        Output.setError(\n          `Please add valid credentials for AWS. Error: ${e.message}`\n        );\n      } else {\n        Output.setError(e.message);\n      }\n    }\n  };\n}\n","import { Logger } from '../utils/logger';\nimport { AppConfig } from './app.config';\nimport * as lowdb from 'lowdb';\nimport express from 'express';\nimport jsonServer = require('json-server');\nimport { StorageAdapter } from '../storage/storage';\nimport { ApiSpecification } from '../specifications/apispecification';\nimport { JSONValidator } from '../validations/json.validator';\nimport { Output } from '../utils/output';\n\nexport class CoreApp {\n  storageAdapter: StorageAdapter;\n  static storage = {} as lowdb.AdapterAsync;\n  static adapter = {} as lowdb.LowdbAsync<{}>;\n  logger = new Logger().logger;\n  appConfig: AppConfig;\n  protected server: express.Express;\n  private apispec: ApiSpecification;\n\n  constructor(\n    appConfig: AppConfig,\n    server: express.Express,\n    storageAdapter: StorageAdapter,\n    apispec: ApiSpecification\n  ) {\n    this.appConfig = appConfig;\n    this.server = server;\n    this.storageAdapter = storageAdapter;\n    this.apispec = apispec;\n  }\n\n  async setup(): Promise<void> {\n    await this.setupStorage();\n    const json = await this.getJSON();\n    const isValid = this.validateJSON(json);\n    if (isValid) {\n      await this.setupApp();\n      this.setupSwagger(json);\n      await this.setupRoutes();\n    } else {\n      Output.setError('provided json is not valid - see validation checks');\n      throw Error('provided json is not valid - see validation checks');\n    }\n  }\n\n  protected async setupStorage() {\n    CoreApp.storage = await this.storageAdapter.init();\n    CoreApp.adapter = await lowdb.default(CoreApp.storage);\n  }\n\n  protected async setupApp(): Promise<void> {\n    const { middlewares, router } = await this.initializeLayers();\n    this.setupServer(middlewares, router);\n  }\n\n  protected validateJSON(db: {}): boolean {\n    let isValid = true;\n    if (this.appConfig.enableJSONValidation) {\n      isValid = JSONValidator.validate(db);\n    }\n    return isValid;\n  }\n\n  protected async getJSON(): Promise<object> {\n    const json = await CoreApp.adapter.getState();\n    return json;\n  }\n\n  protected setupSwagger(db: {}): void {\n    if (this.appConfig.enableSwagger) {\n      this.apispec.generateSpecification(db, true);\n    }\n  }\n\n  protected setupRoutes(): void {\n    this.server.use('/reload', async () => {\n      Error('not implemented');\n    });\n  }\n\n  protected async initializeLayers() {\n    if (\n      CoreApp.adapter &&\n      Object.entries(CoreApp.adapter).length === 0 &&\n      CoreApp.adapter.constructor === Object\n    ) {\n      CoreApp.adapter = await lowdb.default(CoreApp.storage);\n    }\n    const router = jsonServer.router(CoreApp.adapter);\n    const middlewares = jsonServer.defaults({\n      readOnly: this.appConfig.readOnly,\n    });\n    return { middlewares, router };\n  }\n\n  protected setupServer(\n    middlewares: express.Handler[],\n    router: express.Router\n  ) {\n    if (this.appConfig.enableSwagger) {\n      middlewares.splice(\n        middlewares.findIndex(x => x.name === 'serveStatic'),\n        1\n      );\n    }\n    this.server.use(middlewares);\n    this.server.use('/api', router);\n  }\n}\n","export * from './cloud.app';\nexport * from './core.app';\nexport * from './app.config';\n","import { CloudApp } from '../app';\nimport { CoreServer } from './server';\nimport express from 'express';\n\nexport class CloudServer extends CoreServer {\n  core: CloudApp;\n  constructor(server: express.Express, core: CloudApp) {\n    super(server, core);\n    this.server = server;\n    this.core = core;\n  }\n\n  async init(): Promise<void> {\n    await this.core.setup();\n    await this.core.request();\n  }\n}\n","import { CoreServer } from './server';\nimport { CloudApp } from '../app';\nimport express from 'express';\n\nexport class DevServer extends CoreServer {\n  core: CloudApp;\n  constructor(server: express.Express, core: CloudApp) {\n    super(server, core);\n    this.server = server;\n    this.core = core;\n  }\n\n  async init(): Promise<void> {\n    await this.core.setup();\n    await this.core.request();\n    this.start(this.server, 3000);\n  }\n}\n","export * from './cloud.server';\nexport * from './dev.server';\nexport * from './local.server';\nexport * from './test.server';\n","import { CoreServer } from './server';\n\nexport class LocalServer extends CoreServer {\n  async init(): Promise<void> {\n    await this.core.setup();\n    this.start(this.server, 3000);\n  }\n}\n","import express from 'express';\nimport { Logger } from '../utils/logger';\nconst logger = new Logger().logger;\nimport { CoreApp } from '../app/core.app';\nexport abstract class CoreServer {\n  core: CoreApp;\n  server: express.Express;\n  constructor(server: express.Express, core: CoreApp) {\n    this.server = server;\n    this.core = core;\n  }\n  abstract async init(): Promise<void>;\n  protected start(server: express.Express, port: number) {\n    // start the web server\n    server.listen(port);\n    logger.info(\n      `JSON Server is running under port ${port}. Use http://localhost:${port} to access it`\n    );\n  }\n}\n","import { CoreServer } from './server';\n\nexport class TestServer extends CoreServer {\n  async init(): Promise<void> {\n    await this.core.setup();\n  }\n}\n","import { Environment } from './environment';\n\nexport class CloudEnvironment extends Environment {\n  s3File: string;\n  s3Bucket: string;\n\n  constructor() {\n    super();\n    this.s3File = process.env.s3File as string;\n    this.s3Bucket = process.env.s3Bucket as string;\n    this.basePath = process.env.basePath as string;\n  }\n}\n","import { Environment } from './environment';\nimport * as dotenv from 'dotenv';\nexport class DevEnvironment extends Environment {\n  s3File: string;\n  s3Bucket: string;\n\n  constructor() {\n    super();\n    dotenv.config();\n    this.s3File = process.env.s3File as string;\n    this.s3Bucket = process.env.s3Bucket as string;\n    this.basePath = process.env.basePath as string;\n  }\n}\n","export class Environment {\n  basePath = '/';\n\n  constructor() {\n    this.basePath = '/';\n  }\n}\n","export * from './cloud.environment';\nexport * from './environment';\nexport * from './dev.environment';\n","import express from 'express';\nimport { LocalServer, DevServer, CloudServer, TestServer } from './coreserver';\nimport { CloudApp, CoreApp, AppConfig } from './app';\nimport {\n  StorageAdapter,\n  FileStorageAdapter,\n  S3StorageAdapter,\n} from './storage';\nimport { ApiSpecification, Swagger, SwaggerConfig } from './specifications';\nimport { CoreServer } from './coreserver/server';\nimport { Environment, DevEnvironment, CloudEnvironment } from './environment';\n\nexport class ServerFactory {\n  static createServer = async (\n    type: string,\n    server: express.Express,\n    appConfig: AppConfig\n  ): Promise<CoreServer> => {\n    let coreserver = {} as CoreServer;\n\n    switch (type) {\n      case 'local': {\n        coreserver = ServerFactory.create(\n          LocalServer,\n          CoreApp,\n          Environment,\n          new FileStorageAdapter(appConfig.jsonFile),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'debug': {\n        coreserver = ServerFactory.create(\n          LocalServer,\n          CoreApp,\n          Environment,\n          new FileStorageAdapter(appConfig.jsonFile),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'development': {\n        const environment = new DevEnvironment();\n        coreserver = ServerFactory.create(\n          DevServer,\n          CloudApp,\n          DevEnvironment,\n          new S3StorageAdapter(environment.s3Bucket, environment.s3File),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'offline': {\n        const environment = new CloudEnvironment();\n        coreserver = ServerFactory.create(\n          CloudServer,\n          CloudApp,\n          DevEnvironment,\n          new S3StorageAdapter(environment.s3Bucket, environment.s3File),\n          appConfig,\n          server\n        );\n        break;\n      }\n      case 'test': {\n        coreserver = ServerFactory.create(\n          TestServer,\n          CoreApp,\n          Environment,\n          new FileStorageAdapter(appConfig.jsonFile),\n          appConfig,\n          server\n        );\n        break;\n      }\n      default: {\n        const environment = new CloudEnvironment();\n        coreserver = ServerFactory.create(\n          CloudServer,\n          CloudApp,\n          CloudEnvironment,\n          new S3StorageAdapter(environment.s3Bucket, environment.s3File),\n          appConfig,\n          server\n        );\n        break;\n      }\n    }\n    await coreserver.init();\n    return coreserver;\n  };\n\n  static create<\n    C extends CoreServer,\n    A extends CoreApp,\n    E extends Environment,\n    S extends StorageAdapter\n  >(\n    coreserver: { new (server: express.Express, app: A): C },\n    app: {\n      new (\n        appConfig: AppConfig,\n        server: express.Express,\n        storage: S,\n        specification: ApiSpecification\n      ): A;\n    },\n    environment: { new (): E },\n    storage: S,\n    appConfig: AppConfig,\n    server: express.Express\n  ): C {\n    const env = new environment();\n    const swagger = new Swagger(\n      server,\n      new SwaggerConfig(appConfig.readOnly, appConfig.enableApiKeyAuth),\n      env.basePath\n    );\n    const core = new coreserver(\n      server,\n      new app(appConfig, server, storage, swagger)\n    );\n    return core;\n  }\n}\n","import express from 'express';\nimport { ServerFactory } from './factory';\nimport { AppConfig } from './app/app.config';\n\nexport const startServer = async (\n  environment: string,\n  server: express.Express,\n  appConfig: AppConfig\n) => {\n  ServerFactory.createServer(environment, server, appConfig);\n};\n\n(async () => {\n  if (require.main === module) {\n    const server = express();\n    const defaultConfig = new AppConfig();\n    defaultConfig.jsonFile = '../../db.json';\n    startServer(process.env.NODE_ENV as string, server, defaultConfig);\n  }\n})();\n","export * from './apispecification';\nexport * from './swagger/swagger';\nexport * from './swagger/swagger.config';\n","export class SwaggerConfig {\n  readOnly = false;\n  enableApiKeyAuth = false;\n\n  constructor(readOnly: boolean, enableApiKeyAuth: boolean) {\n    this.readOnly = readOnly;\n    this.enableApiKeyAuth = enableApiKeyAuth;\n  }\n}\n","/* eslint-disable no-use-before-define */\n\nexport class SwaggerDefGen {\n  private outSwagger = '';\n  private tabCount = 0;\n  private indentator = '';\n  private nullType = 'string';\n  // ---- Functions definitions ----\n  private changeIndentation(count: number) {\n    /*\n      Assign 'this.indentator' a string beginning with newline and followed by 'count' tabs\n      Updates variable 'tabCount' with the number of tabs used\n      Global variables updated:\n      -identator\n      -tabcount\n      */\n\n    let i;\n    if (count >= this.tabCount) {\n      i = this.tabCount;\n    } else {\n      i = 0;\n      this.indentator = '\\n';\n    }\n    for (; i < count; i += 1) {\n      this.indentator += '\\t';\n    }\n    // Update tabCount\n    this.tabCount = count;\n  }\n\n  private isFloatNumber(num: number) {\n    return Number(num) === num && num % 1 !== 0;\n  }\n  private convertNumber(num: number) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given number\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    if (Number.isInteger(num)) {\n      this.outSwagger += `${this.indentator}\"type\": \"integer\",`;\n      if (num < 2147483647 && num > -2147483647) {\n        this.outSwagger += `${this.indentator}\"format\": \"int32\"`;\n      } else if (Number.isSafeInteger(num)) {\n        this.outSwagger += `${this.indentator}\"format\": \"int64\"`;\n      } else {\n        this.outSwagger += `${this.indentator}\"format\": \"unsafe\"`;\n      }\n    } else if (this.isFloatNumber(num)) {\n      this.outSwagger += `${this.indentator}\"format\": \"double\"`;\n    } else {\n      this.outSwagger += `${this.indentator}\"format\": \"unsafe\"`;\n    }\n    this.outSwagger += `,${this.indentator}\"example\": \"${num}\"`;\n  }\n\n  // date is ISO8601 format - https://xml2rfc.tools.ietf.org/public/rfc/html/rfc3339.html#anchor14\n  private convertString(str: string) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given string\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    const regxDate = /^(19|20)\\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/;\n    const regxDateTime = /^(19|20)\\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01]).([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\\.[0-9]{1,2})?(Z|(\\+|-)([0-1][0-9]|2[0-3]):[0-5][0-9])$/;\n\n    this.outSwagger += `${this.indentator}\"type\": \"string\"`;\n    if (regxDateTime.test(str)) {\n      this.outSwagger += ',';\n      this.outSwagger += `${this.indentator}\"format\": \"date-time\"`;\n    } else if (regxDate.test(str)) {\n      this.outSwagger += ',';\n      this.outSwagger += `${this.indentator}\"format\": \"date\"`;\n    }\n\n    this.outSwagger += `,${this.indentator}\"example\": \"${str}\"`;\n  }\n\n  private convertArray(obj: object) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given array\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    this.outSwagger += `${this.indentator}\"type\": \"array\",`;\n    // ---- Begin items scope ----\n    this.outSwagger += `${this.indentator}\"items\": {`;\n    this.conversorSelection(obj);\n    this.outSwagger += `${this.indentator}}`;\n    // ---- End items scope ----\n  }\n\n  private convertObject(obj: object) {\n    /*\n      Append to 'this.outSwagger' string with Swagger schema attributes relative to given object\n      Global variables updated:\n      -this.outSwagger\n      */\n\n    // Convert null attributes to given type\n    if (obj === null) {\n      this.outSwagger += `${this.indentator}\"type\": \"${this.nullType}\",`;\n      this.outSwagger += `${this.indentator}\"format\": \"nullable\"`;\n      return;\n    }\n    // ---- Begin properties scope ----\n    this.outSwagger += `${this.indentator}\"type\": \"object\",`;\n    this.outSwagger += `${this.indentator}\"properties\": {`;\n    this.changeIndentation(this.tabCount + 1);\n    // For each attribute inside that object\n    Object.keys(obj).forEach(prop => {\n      // ---- Begin property type scope ----\n      this.outSwagger += `${this.indentator}\"${prop}\": {`;\n      this.conversorSelection(obj[prop]);\n      this.outSwagger += `${this.indentator}},`;\n      // ---- End property type scope ----\n    });\n\n    this.changeIndentation(this.tabCount - 1);\n    if (Object.keys(obj).length > 0) {\n      // At least 1 property inserted\n      this.outSwagger = this.outSwagger.substring(\n        0,\n        this.outSwagger.length - 1\n      ); // Remove last comma\n      this.outSwagger += `${this.indentator}}`;\n    } else {\n      // No property inserted\n      this.outSwagger += ' }';\n    }\n  }\n\n  private conversorSelection(obj: object) {\n    this.changeIndentation(this.tabCount + 1);\n    if (typeof obj === 'number') {\n      // attribute is a number\n      this.convertNumber(obj);\n    } else if (Object.prototype.toString.call(obj) === '[object Array]') {\n      // attribute is an array\n      this.convertArray(obj[0]);\n    } else if (typeof obj === 'object') {\n      // attribute is an object\n      this.convertObject(obj);\n    } else if (typeof obj === 'string') {\n      // attribute is a string\n      this.convertString(obj);\n    } else if (typeof obj === 'boolean') {\n      // attribute is a boolean\n      this.outSwagger += `${this.indentator}\"type\": \"boolean\"`;\n    } else {\n      // not a valid Swagger type\n      throw new Error(\n        `Property type \"${typeof obj}\" not valid for Swagger definitions`\n      );\n    }\n    this.changeIndentation(this.tabCount - 1);\n  }\n\n  generateDefinitions = (json: object) => {\n    this.tabCount = 0;\n    this.indentator = '\\n';\n    // ---- Begin definitions ----\n    this.outSwagger = '{\"definitions\": {';\n    this.changeIndentation(1);\n    // For each object inside the JSON\n\n    Object.keys(json).forEach(obj => {\n      this.outSwagger += `${this.indentator}\"${obj}\": {`;\n      this.conversorSelection(json[obj]);\n      this.outSwagger += `${this.indentator}},`;\n    });\n\n    // Remove last comma\n    this.outSwagger = this.outSwagger.substring(0, this.outSwagger.length - 1);\n    // ---- End definitions ----\n    this.changeIndentation(this.tabCount - 1);\n    this.outSwagger += `${this.indentator}}}`;\n    const jsonDefinition = JSON.parse(this.outSwagger);\n    return jsonDefinition;\n  };\n}\n","import _ from 'lodash';\nconst listEndpoints = require('express-list-endpoints');\nimport express from 'express';\nimport packageInfo from '../../../../../package.json';\nimport {\n  Info,\n  Spec,\n  Schema,\n  ApiKeySecurity,\n  Operation,\n  QueryParameter,\n  BodyParameter,\n  Reference,\n} from 'swagger-schema-official';\n\ninterface EndPoint {\n  path: string;\n  methods: string[];\n}\n\nexport class SwaggerSpec {\n  private packageJsonPath = `${process.cwd()}/package.json`;\n  private packageInfo = packageInfo;\n  private app = {} as express.Express;\n  private predefinedSpec = {} as object;\n  private spec = {} as Spec;\n\n  constructor() {}\n  private updateSpecFromPackage(basePath: string): Info {\n    const newInfo: Info = {\n      version: '',\n      title: '',\n    };\n    this.packageInfo = packageInfo;\n    if (this.packageInfo.name) {\n      newInfo.title = this.packageInfo.name;\n    }\n    if (this.packageInfo.version) {\n      newInfo.version = this.packageInfo.version;\n    }\n    if (this.packageInfo.license) {\n      newInfo.license = { name: this.packageInfo.license };\n    }\n    newInfo.description = `[Specification JSON](${basePath}/api-spec)`;\n\n    if (this.packageInfo.description) {\n      newInfo.description += `\\n\\n${this.packageInfo.description}`;\n    }\n    return newInfo;\n  }\n  private sortObject(o: object) {\n    const sorted = {};\n    let key;\n    const a = Object.keys(o);\n    a.sort();\n    for (key = 0; key < a.length; key += 1) {\n      sorted[a[key]] = o[a[key]];\n    }\n    return sorted;\n  }\n\n  initSpec(readOnly: boolean, basePath: string) {\n    const info = this.updateSpecFromPackage(basePath);\n    let specification: Spec = {\n      swagger: '2.0',\n      paths: {},\n      info,\n    };\n    specification.swagger = '2.0';\n    specification.paths = {};\n    const excludedRoutes = ['/api/:resource/:id/:nested', '/api/db'];\n    const endpoints = listEndpoints(this.app);\n    endpoints.forEach((endpoint: EndPoint) => {\n      if (readOnly) {\n        for (let i = 0; i < endpoint.methods.length; i += 1) {\n          if (endpoint.methods[i] !== 'GET') {\n            endpoint.methods.splice(i, 1);\n            i -= 1;\n          }\n        }\n      }\n      if (!excludedRoutes.includes(endpoint.path)) {\n        const params = new Array<string>();\n        let { path } = endpoint;\n        const matches = path.match(/:([^/]+)/g);\n        if (matches) {\n          matches.forEach(found => {\n            const paramName = found.substr(1);\n            path = path.replace(found, `{${paramName}}`);\n            params.push(paramName);\n          });\n        }\n\n        if (!specification.paths[path]) {\n          specification.paths[path] = {};\n        }\n        endpoint.methods.forEach(m => {\n          specification.paths[path][m.toLowerCase()] = {\n            summary: path,\n            consumes: ['application/json'],\n            parameters:\n              params.map(p => ({\n                name: p,\n                in: 'path',\n                required: true,\n                type: 'integer',\n              })) || [],\n            responses: {},\n          };\n        });\n      }\n    });\n\n    specification.basePath = basePath;\n    specification = this.sortObject(\n      _.merge(specification, this.predefinedSpec || {})\n    ) as Spec;\n    return specification;\n  }\n\n  getSpec = (\n    app: express.Express,\n    predefinedSpec: object,\n    readOnly: boolean,\n    basePath: string\n  ) => {\n    this.app = app;\n    this.predefinedSpec = predefinedSpec;\n    this.spec = this.initSpec(readOnly, basePath);\n    return this.spec;\n  };\n\n  setSchemaReference(spec: Spec, definition: string): Reference {\n    let schemaDef = {} as Reference;\n    if (spec.definitions![definition].type === 'array') {\n      schemaDef = { $ref: `#/definitions/${definition}/items` } as Reference;\n    } else if (spec.definitions![definition].type === 'object') {\n      schemaDef = { $ref: `#/definitions/${definition}` } as Reference;\n    }\n    return schemaDef;\n  }\n\n  private getDefaultParameterSchema(\n    schemaDef: Schema,\n    definition: string\n  ): BodyParameter {\n    return {\n      schema: schemaDef,\n      in: 'body',\n      name: 'body',\n      description: definition,\n      required: true,\n    };\n  }\n\n  getQueryParameterSchema(): QueryParameter[] {\n    return [\n      {\n        name: '_page',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to return paginated data',\n      },\n      {\n        name: '_limit',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to limit paginated data',\n      },\n      {\n        name: '_sort',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'sort by attributes',\n      },\n      {\n        name: '_order',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'order ascending or descending',\n        enum: ['asc', 'desc'],\n      },\n      {\n        name: '_start',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to set start sliced data',\n      },\n      {\n        name: '_end',\n        in: 'query',\n        required: false,\n        type: 'integer',\n        description: 'parameter to set start sliced data',\n      },\n      {\n        name: 'q',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'full text search',\n      },\n      {\n        name: '_embed',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'include children resources',\n      },\n      {\n        name: '_expand',\n        in: 'query',\n        required: false,\n        type: 'string',\n        description: 'include parent resource',\n      },\n    ];\n  }\n\n  private getDefaultPostResponses(definition: string) {\n    return {\n      responses: {\n        200: {\n          description: 'successful operation',\n          schema: {\n            $ref: `#/definitions/${definition}`,\n          },\n        },\n        400: {\n          description: `Invalid ${definition}`,\n        },\n      },\n    };\n  }\n\n  private getDefaultPutResponses(definition: string) {\n    return {\n      responses: {\n        400: {\n          description: 'Invalid ID supplied',\n        },\n        404: {\n          description: `${definition} not found`,\n        },\n        405: {\n          description: 'Validation exception',\n        },\n      },\n    };\n  }\n\n  private getDefaultDeleteResponses(definition: string) {\n    return {\n      responses: {\n        400: {\n          description: 'Invalid ID supplied',\n        },\n        404: {\n          description: `${definition} not found`,\n        },\n      },\n    };\n  }\n\n  private getDefaultSchemaProperties(definition: string) {\n    return {\n      produces: ['application/json'],\n      tags: [definition],\n    };\n  }\n\n  addSchemaDefitions = (specificaton: Spec, schemaDefinitons: Schema) => {\n    const spec = Object.assign(specificaton, schemaDefinitons) as Spec;\n    Object.keys(spec.paths).forEach(path => {\n      Object.keys(spec.definitions!).forEach((definition: string) => {\n        const schemaDef = this.setSchemaReference(spec, definition);\n        if (path.endsWith(definition)) {\n          if (spec.paths[path].get) {\n            const operation = spec.paths[path].get as Operation;\n            Object.assign(\n              spec.paths[path].get,\n              this.getDefaultSchemaProperties(definition)\n            );\n            operation.responses[200] = {\n              schema: { $ref: `#/definitions/${definition}` },\n              description: 'successful operation',\n            };\n            operation.parameters = this.getQueryParameterSchema();\n          }\n          if (spec.paths[path].post) {\n            const operation = spec.paths[path].post as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPostResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n          if (spec.paths[path].put) {\n            const operation = spec.paths[path].put as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n          if (spec.paths[path].patch) {\n            const operation = spec.paths[path].patch as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n        }\n        if (path.endsWith(`${definition}/{id}`)) {\n          if (spec.paths[path].get) {\n            const operation = spec.paths[path].get as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            operation.responses[200] = {\n              schema: { $ref: `#/definitions/${definition}` },\n              description: 'successful operation',\n            };\n          }\n          if (spec.paths[path].delete) {\n            const operation = spec.paths[path].delete as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(\n              operation,\n              this.getDefaultDeleteResponses(definition)\n            );\n          }\n\n          if (spec.paths[path].put) {\n            const operation = spec.paths[path].put as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n          if (spec.paths[path].patch) {\n            const operation = spec.paths[path].patch as Operation;\n            Object.assign(\n              operation,\n              this.getDefaultSchemaProperties(definition)\n            );\n            Object.assign(operation, this.getDefaultPutResponses(definition));\n            operation.parameters!.push(\n              this.getDefaultParameterSchema(schemaDef, definition)\n            );\n          }\n        }\n      });\n    });\n    return spec;\n  };\n\n  addAuthentication = (specificaton: Spec, auth: ApiKeySecurity) => {\n    const spec = Object.assign(specificaton.securityDefinitions, auth);\n    return spec;\n  };\n}\n","import * as swaggerUi from 'swagger-ui-express';\nimport { SwaggerSpec } from './swagger.spec';\nimport { SwaggerDefGen } from './swagger.defgen';\nimport { Logger } from '../../utils/logger';\nimport express from 'express';\nimport { Spec, ApiKeySecurity } from 'swagger-schema-official';\nimport { SwaggerConfig } from './swagger.config';\nimport { ApiSpecification } from '../apispecification';\nimport { Output } from '../../utils/output';\n\nexport class Swagger implements ApiSpecification {\n  private swaggerSpec = new SwaggerSpec();\n  private swaggerDefGen = new SwaggerDefGen();\n  private logger = new Logger().logger;\n  private spec = {} as Spec;\n  private server: express.Express;\n  private config: SwaggerConfig;\n  private basePath: string;\n  constructor(\n    server: express.Express,\n    config: SwaggerConfig,\n    basePath: string\n  ) {\n    this.server = server;\n    this.config = config;\n    this.basePath = basePath;\n  }\n\n  generateSpecification = (json: object, regenerate: boolean) => {\n    if (!this.spec || regenerate) {\n      Output.setInfo('Init Swagger');\n      const swaggerSchemaDefinitions = this.swaggerDefGen.generateDefinitions(\n        json\n      );\n      this.spec = this.swaggerSpec.getSpec(\n        this.server,\n        {},\n        this.config.readOnly,\n        this.basePath\n      );\n      const auth: ApiKeySecurity = {\n        type: 'apiKey',\n        in: 'header',\n        name: 'x-api-key',\n        description:\n          'All requests must include the `x-api-key` header containing your account ID.',\n      };\n\n      if (this.config.enableApiKeyAuth) {\n        this.swaggerSpec.addAuthentication(this.spec, auth);\n      }\n      this.swaggerSpec.addSchemaDefitions(this.spec, swaggerSchemaDefinitions);\n    }\n    this.server.use('/api-spec', (req, res) => {\n      res.setHeader('Content-Type', 'application/json');\n      res.send(this.spec);\n    });\n    this.server.use('/', swaggerUi.serve, swaggerUi.setup(this.spec));\n  };\n}\n","import { StorageAdapter } from './storage';\nimport fs from 'fs';\nimport FileAsync from 'lowdb/adapters/FileAsync';\n\nexport class FileStorageAdapter implements StorageAdapter {\n  private initialFilePath: string;\n  constructor(initialFilePath: string) {\n    this.initialFilePath = initialFilePath;\n  }\n\n  async init(): Promise<import('lowdb').AdapterAsync> {\n    const storageAdapter = new FileAsync(this.initialFilePath);\n    return storageAdapter;\n  }\n}\n","export * from './file.storage';\nexport * from './storage';\nexport * from './s3.storage';\n","import { StorageAdapter } from './storage';\nimport fs from 'fs';\nconst awsAdapter = require('lowdb-adapter-aws-s3');\n\nexport class S3StorageAdapter implements StorageAdapter {\n  private s3bucket: string;\n  private s3file: string;\n  constructor(s3bucket: string, s3file: string) {\n    this.s3bucket = s3bucket;\n    this.s3file = s3file;\n  }\n\n  async init(): Promise<import('lowdb').AdapterAsync> {\n    const db = JSON.parse(fs.readFileSync(this.s3file, 'UTF-8'));\n    const storageAdapter = new awsAdapter(this.s3file, {\n      defaultValue: db,\n      aws: { bucketName: this.s3bucket },\n    });\n    return storageAdapter;\n  }\n}\n","export class Logger {\n  logger = require('pino')(\n    {\n      prettyPrint: { colorize: true },\n    },\n    process.stderr\n  );\n}\n","import { Logger } from './logger';\n\nexport class Output {\n  static setWarning(message: string) {\n    new Logger().logger.warning(message);\n  }\n  static setError(message: string) {\n    new Logger().logger.error(message);\n  }\n  static setInfo(message: string) {\n    new Logger().logger.info(message);\n  }\n}\n","import {\n  HasIdAttributeRule,\n  HasObjectKeyRule,\n  IsObjectRule,\n  ValidationRule,\n} from './validationrule';\nimport { RuleResultSeverity } from './ruleevent';\nimport { Output } from '../utils/output';\nexport class JSONValidator {\n  static validate(json: {}): boolean {\n    let isValid = true;\n    const rules = new Array<ValidationRule>();\n    rules.push(new IsObjectRule(json));\n    rules.push(new HasObjectKeyRule(json));\n    rules.push(new HasIdAttributeRule(json));\n\n    Output.setInfo(\n      'ValidationRule:' +\n        'Result'.padStart(60 - 'ValidationRule'.length) +\n        'Message'.padStart(80)\n    );\n    for (const rule of rules) {\n      const results = rule.executeValidation();\n      for (const result of results.events) {\n        Output.setInfo(\n          results.validationRule +\n            ':' +\n            result.result\n              .toString()\n              .padStart(60 - results.validationRule!.length) +\n            result.message.padStart(80)\n        );\n        if (result.result === RuleResultSeverity.ALERT) {\n          isValid = false;\n        }\n      }\n    }\n    return isValid;\n  }\n}\n","export class RuleEventList {\n  validationRule?: string;\n  events = new Array<RuleEvent>();\n}\n\nexport class RuleEvent {\n  result: RuleResultSeverity;\n  message = '' as string;\n\n  constructor(result: RuleResultSeverity, message?: string) {\n    this.result = result;\n    this.message = message !== undefined ? message : '';\n  }\n}\n\nexport enum RuleResultSeverity {\n  OK = 'OK',\n  WARNING = 'WARNING',\n  ALERT = 'ALERT',\n}\n","import { RuleEvent, RuleResultSeverity, RuleEventList } from './ruleevent';\n\nexport abstract class ValidationRule {\n  protected jsonObject = {} as object;\n  ruleEvents = new Array<RuleEvent>();\n  constructor(jsonObject: {}) {\n    this.jsonObject = jsonObject;\n  }\n  events = new Array<string>();\n  executeValidation(): RuleEventList {\n    const ruleEventList = new RuleEventList();\n    const result = this.validate();\n    ruleEventList.events = ruleEventList.events.concat(result);\n    ruleEventList.validationRule = this.constructor.name;\n    return ruleEventList;\n  }\n\n  protected abstract validate(): RuleEvent[];\n}\n\nexport class IsObjectRule extends ValidationRule {\n  validate(): RuleEvent[] {\n    let ruleSeverity = RuleResultSeverity.OK;\n    let message = '';\n    try {\n      if (\n        this.jsonObject &&\n        typeof this.jsonObject === 'object' &&\n        this.jsonObject.constructor !== Object\n      ) {\n        ruleSeverity = RuleResultSeverity.ALERT;\n        message = 'root level of json content must be a json object';\n      }\n    } catch (e) {\n      ruleSeverity = RuleResultSeverity.ALERT;\n      message = e.message;\n    }\n    this.ruleEvents.push(new RuleEvent(ruleSeverity, message));\n    return this.ruleEvents;\n  }\n}\n\nexport class HasObjectKeyRule extends ValidationRule {\n  validate(): RuleEvent[] {\n    let ruleSeverity = RuleResultSeverity.OK;\n    let message = '';\n    try {\n      if (this.jsonObject && typeof this.jsonObject === 'object') {\n        if (Object.keys(this.jsonObject).length === 0) {\n          ruleSeverity = RuleResultSeverity.ALERT;\n          message = 'no root properties found - no endpoints can be created';\n        }\n      }\n    } catch (e) {\n      ruleSeverity = RuleResultSeverity.ALERT;\n      message = e.message;\n    }\n    this.ruleEvents.push(new RuleEvent(ruleSeverity, message));\n    return this.ruleEvents;\n  }\n}\n\nexport class HasIdAttributeRule extends ValidationRule {\n  validate(): RuleEvent[] {\n    try {\n      if (\n        this.jsonObject &&\n        typeof this.jsonObject === 'object' &&\n        Object.keys(this.jsonObject).length !== 0\n      ) {\n        Object.keys(this.jsonObject).forEach(item => {\n          let ruleSeverity = RuleResultSeverity.OK;\n          let message = '';\n          if (\n            Array.isArray(this.jsonObject[item]) &&\n            this.jsonObject[item].length > 0 &&\n            !this.jsonObject[item][0].hasOwnProperty('id')\n          ) {\n            (ruleSeverity = RuleResultSeverity.WARNING),\n              (message =\n                item +\n                ' is missing id attribute - not possible to do POST, PUT, PATCH');\n          }\n          this.ruleEvents.push(new RuleEvent(ruleSeverity, message));\n        });\n      }\n    } catch (e) {\n      const ruleSeverityError = RuleResultSeverity.ALERT;\n      const messageError = e.message;\n      this.ruleEvents.push(new RuleEvent(ruleSeverityError, messageError));\n    }\n    return this.ruleEvents;\n  }\n}\n","module.exports = require(\"dotenv\");","module.exports = require(\"express\");","module.exports = require(\"express-list-endpoints\");","module.exports = require(\"fs\");","module.exports = require(\"json-server\");","module.exports = require(\"lodash\");","module.exports = require(\"lowdb\");","module.exports = require(\"lowdb-adapter-aws-s3\");","module.exports = require(\"lowdb/adapters/FileAsync\");","module.exports = require(\"pino\");","module.exports = require(\"swagger-ui-express\");"],"sourceRoot":""}